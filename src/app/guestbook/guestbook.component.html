<div class="container">
    <div class="row">
        <div class="col-xs-12 col-md-8 col-lg-9 col-xl-9">
            <div class="row">
                <div class="col-xs-12">
                    <h2>Гостьова:</h2>
                </div>
            </div>
            <div *ngIf="authenticatedUser" class="row">
                <div class="col-xs-12">
                    <form novalidate [formGroup]="guestbookAddMessageForm"
                          (ngSubmit)="onSubmit(guestbookAddMessageForm)" class="bg-inverse text-white dark-form">
                        <input type="hidden" name="user_id" formControlName="user_id">
                        <div class="form-group"
                             [class.has-danger]="guestbookAddMessageForm.get('body').invalid && (guestbookAddMessageForm.get('body').touched || !guestbookAddMessageForm.get('body').pristine)">
                            <label class="form-control-label" for="body"><strong>Добавити повідомлення:</strong></label>
                            <textarea id="body"
                                      placeholder="Напишіть щось..."
                                      class="form-control"
                                      name="body"
                                      rows="3"
                                      formControlName="body">
                            </textarea>
                            <div *ngIf="guestbookAddMessageForm.get('body').hasError('required') && (guestbookAddMessageForm.get('body').touched || !guestbookAddMessageForm.get('body').pristine)"
                                 class="form-control-feedback">
                                <small>Текст повідомлення обов'язковий.</small>
                            </div>
                            <div *ngIf="guestbookAddMessageForm.get('body').hasError('minlength') && !guestbookAddMessageForm.get('body').pristine"
                                 class="form-control-feedback">
                                <small>Текст повідомлення повинен бути більшим ніж 10 символів.</small>
                            </div>
                            <div *ngIf="guestbookAddMessageForm.get('body').hasError('maxlength') && !guestbookAddMessageForm.get('body').pristine"
                                 class="form-control-feedback">
                                <small>Текст повідомлення перевищує 1000 символів.</small>
                            </div>
                        </div>
                        <button [hidden]="preloader"
                                [disabled]="guestbookAddMessageForm.invalid"
                                type="submit"
                                class="btn btn-primary">Додати
                        </button>
                        <app-spinner-button [hidden]="!preloader"></app-spinner-button>
                    </form>
                </div>
            </div>
            <app-spinner *ngIf="!error && !guestbookMessages" [height]="500"></app-spinner>
            <div *ngIf="guestbookMessages" class="row">
                <div class="col-xs-12">
                    <div *ngFor="let message of guestbookMessages" class="card">
                        <div class="card-block">
                            <div class="h4 card-title">
                                <img class="rounded small-image"
                                     src="{{userImagesUrl}}{{message.user.image || userImageDefault}}"
                                     alt="{{message.user.name}}">
                                {{message.user.name}} <small *ngIf="message.user.hometown" class="text-muted">({{message.user.hometown}})</small>
                            </div>
                            <p class="card-text">{{message.body}}</p>
                            <p class="card-text">
                                <small class="text-muted">{{message.created_at}}</small>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row" *ngIf="error">
                <div class="col-xs-12">
                    <div class="alert alert-danger" role="alert">
                        <strong>{{error}}</strong>
                    </div>
                </div>
            </div>
            <div class="row text-xs-center pagination-row">
                <app-pagination [totalItems]="total"
                                [currentPage]="currentPage"
                                [pageSize]="perPage"
                                [path]="path">
                </app-pagination>
            </div>
        </div>
        <div class="hidden-sm-down col-md-4 col-lg-3 col-xl-3">
            <div class="row">
                <div class="col-xs-12">
                    <app-last-user></app-last-user>
                </div>
            </div>
        </div>
    </div>
</div>