<div *ngIf="cupRating" class="row">
    <div class="col-12">
        <h2>Рейтинг гравців: </h2>
    </div>
</div>
<app-error *ngIf="errorCupRating" [message]="errorCupRating"></app-error>
<div *ngIf="cupRating" class="card">
    <div class="table-responsive black-border black-shadow">
        <table class="table table-striped table-bordered table-hover table-sm m-0">
            <thead class="thead-dark">
                <tr>
                    <th class="text-center align-middle">№</th>
                    <th class="text-center align-middle" title="Улюблена команда">
                        <i class="fa fa-shield" aria-hidden="true"></i><br>
                    </th>
                    <th title="Ім'я гравця" class="align-middle">Ім'я</th>
                    <th class="text-center">
                        {{beforePreviousSeason ? beforePreviousSeason.title : ''}}
                        <small class="text-muted text-nowrap">(Рейтинг * {{cupRating[0].before_previous_coefficient}})</small>
                    </th>
                    <th class="text-center">
                        {{previousSeason ? previousSeason.title : ''}}
                        <small class="text-muted text-nowrap">(Рейтинг * {{cupRating[0].previous_coefficient}})</small>
                    </th>
                    <th class="text-center">
                        {{activeSeason ? activeSeason.title : ''}}
                        <small class="text-muted text-nowrap">(Рейтинг * {{cupRating[0].active_coefficient}})</small>
                    </th>
                    <th title="Сума очок за три сезони" class="text-center align-middle">
                        Сума
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let cupRatingItem of cupRating; let i = index;"
                    class="cursor-pointer"
                    [ngClass]="{'table-active': authenticatedUser && (cupRatingItem.user_id === authenticatedUser.id)}"
                    [routerLink]="cupRatingItem.user_id">
                    <th scope="row" class="text-center">{{i + 1}}.</th>
                    <td class="text-center p-1">
                        <img *ngIf="cupRatingItem.user?.main_club?.length"
                             data-toggle="tooltip"
                             data-placement="left"
                             data-html="true"
                             title="<img src='{{clubsImagesUrl + cupRatingItem.user.main_club[0].image}}' alt='{{cupRatingItem.user.main_club[0].title}}' class='img-fluid p-2'>"
                             [attr.src]="clubsImagesUrl + cupRatingItem.user.main_club[0].image"
                             [attr.alt]="cupRatingItem.user.main_club[0].title"
                             class="small-image">
                    </td>
                    <td>
                        <strong>{{cupRatingItem.user.name}}</strong>
                        {{helperService.getHometown(cupRatingItem.user.hometown)}}
                    </td>
                    <td class="text-center text-muted"><small>{{cupRatingItem.before_previous_season_points.toFixed(2)}}</small></td>
                    <td class="text-center text-muted"><small>{{cupRatingItem.previous_season_points.toFixed(2)}}</small></td>
                    <td class="text-center text-muted"><small>{{cupRatingItem.active_season_points.toFixed(2)}}</small></td>
                    <td class="font-weight-bold text-center">{{cupRatingItem.points_summary.toFixed(2)}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
